---
title: "Mobile Integration"
description: "Stripe payments integration in the mobile app with subscriptions and one-time purchases"
---

# Mobile Stripe Integration

Launch includes a complete Stripe payments screen in the mobile app that demonstrates both subscription and one-time purchase flows.

<Frame>
  <img src="/images/stripe-mobile.png" alt="Stripe payments screen" />
</Frame>

## Features

The mobile Stripe integration supports:

- **One-time payments** - Single purchases using Stripe PaymentSheet
- **Subscriptions** - Monthly and yearly plans via Stripe Checkout
- **Automatic product loading** - Fetches products directly from your Stripe account
- **Setup status checks** - Verifies backend connection, Stripe configuration, and product availability
- **Native payment UI** - Uses `@stripe/stripe-react-native` for secure payment handling

## Architecture

```
┌─────────────────────────────────────────────────────┐
│                    Mobile App                        │
│  ┌─────────────────────────────────────────────┐    │
│  │         Stripe Payments Screen              │    │
│  │  • Fetches products from backend            │    │
│  │  • Displays pricing options                 │    │
│  │  • Handles purchase flow                    │    │
│  └─────────────────────────────────────────────┘    │
│                        │                             │
│                        ▼                             │
│  ┌─────────────────────────────────────────────┐    │
│  │     One-time Purchase    │   Subscription    │    │
│  │     PaymentSheet         │   Checkout URL    │    │
│  └─────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────┘
                         │
                         ▼
┌─────────────────────────────────────────────────────┐
│                    Backend API                       │
│  • createPaymentIntent - One-time payments          │
│  • createCheckoutSession - Subscriptions            │
│  • getProducts - Fetch Stripe products              │
│  • Webhooks - Process payment events                │
└─────────────────────────────────────────────────────┘
                         │
                         ▼
┌─────────────────────────────────────────────────────┐
│                      Stripe                          │
│  • Products & Prices                                │
│  • Payment processing                               │
│  • Subscription management                          │
└─────────────────────────────────────────────────────┘
```

## Payment Flows

### One-time Purchases

For one-time payments, the app uses Stripe's native PaymentSheet:

1. User taps "Buy now" on a one-time product
2. App calls `createPaymentIntent` on the backend
3. Backend creates a PaymentIntent with Stripe
4. App presents the native PaymentSheet
5. User completes payment
6. Webhook confirms payment and updates database

### Subscriptions

For subscriptions, the app uses Stripe Checkout:

1. User taps "Subscribe" on a subscription product
2. App calls `createCheckoutSession` on the backend
3. Backend creates a Checkout Session with Stripe
4. App opens Stripe Checkout in an in-app browser
5. User completes subscription
6. Browser auto-closes on redirect
7. Webhook creates subscription record in database

## File Structure

```
apps/mobile/
├── app/payments/
│   ├── index.tsx          # Payment providers list
│   └── stripe.tsx         # Stripe integration screen
└── app.config.ts          # Stripe plugin configuration

apps/api/
├── src/routers/stripe.ts           # tRPC endpoints
├── src/routes/stripe-webhooks.ts   # Webhook handler
└── src/services/subscription.ts    # Subscription logic
```

## Key Components

### Stripe Screen (`app/payments/stripe.tsx`)

The main Stripe screen includes:

- **Setup Status Card** - Shows connection status for backend, Stripe, and products
- **Products List** - Displays all active products from Stripe
- **Pricing Options** - Shows each price with Subscribe/Buy now buttons
- **Loading State** - Full-screen spinner while fetching products

### Backend Endpoints

| Endpoint | Purpose |
|----------|---------|
| `stripe.getProducts` | Fetch active products with prices |
| `stripe.createPaymentIntent` | Create intent for one-time payment |
| `stripe.createCheckoutSession` | Create session for subscription |
| `stripe.getSubscriptionStatus` | Check user's subscription status |

## Setup Requirements

1. **Stripe Account** - Create products and prices in Stripe Dashboard
2. **Environment Variables** - Configure API keys (see [Environment Setup](/payments/environment-setup))
3. **Webhooks** - Set up webhook endpoint (see [Stripe Setup](/payments/stripe-setup))
4. **Native Build** - Run `npx expo run:ios` after installing Stripe SDK

## Testing

Use Stripe test cards for development:

| Card Number | Result |
|------------|--------|
| `4242 4242 4242 4242` | Success |
| `4000 0000 0000 0002` | Decline |
| `4000 0000 0000 3220` | 3D Secure |

**CVV**: Any 3 digits | **Expiry**: Any future date

## What's Next?

- [Stripe Setup](/payments/stripe-setup) - Complete setup guide
- [Database Schema](/payments/database-schema) - Payment data models
- [Environment Setup](/payments/environment-setup) - Configure API keys




